<div class="createnewpage pagebg" ng-controller="updateRuleController">
    <div class="container-fluid">
        <div class="row">
            <div ng-show="pagemain.main">
                <div class="sub_menu">
                    <ul>
                        <li class="active btn btn-sub-menu"> <a ng-click="pageUsecase()">Use Cases</a></li>
                        <li class="btn btn-sub-menu"> <a ng-click="pageRule()">Rule</a></li>
                    </ul>
                </div>
            </div>
            <div ng-show="pagemain.usecase">
                <div class="sub_menu">
                    <ul>
                        <li class="active btn btn-sub-menu"> <a ui-sref="home.createusecase">Create Use Cases</a></li>
                        <li class="btn btn-sub-menu"> <a ui-sref="home.updateUsecase">Update Use Cases</a></li>
                    </ul>
                </div>
            </div>
            <div ng-show="pagemain.rule">
                <div class="sub_menu">
                    <ul>
                        <li class="btn btn-sub-menu"> <a ui-sref="home.createrule">Create Rule</a></li>
                        <li class="btn btn-sub-menu"> <a ui-sref="home.updateRule">Update Rule</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="createnew-head">
                <div class="col-md-6 col-sm-6">
                    <h2 class="title-head"> Update Rule </h2>
                </div>
            </div>
        </div>
        <hr>
    </div>
    <div ng-show='updateUsecase.SearchPage'>
        <div class="container">
            <div class="row">
                <div class="col-md-offset-2 col-md-3 col-sm-3">
                    <label style="font-size:16px;">Search By Rule ID </label>
                </div>
                <div class="col-md-3 col-sm-4">
                    <input type="text" class="form-control" required placeholder="Rule ID" ng-model="UpdateRuleID">
                </div>
                <div class="col-md-3 col-sm-2">
                    <button ng-click="Search_RuleUsecase()" class="btn btn-primary">
                        <span class="glyphicon glyphicon-search" style="font-size:13px"></span> Search RuleID</button>
                </div>
            </div>
        </div>
    </div>
    <div ng-show='updateUsecase.updatePage'>
        <div class="container">
            <form name="updateRuleFrom" novalidate autocomplete="off" enctype="multipart/form-data">
                <div class="row">
                    <div class="tabs">
                        <div class="tabsreg col-md-12 pull-center">
                            <div class="margintp1 col-md-12 col-sm-12 ">
                                <div class="row">
                                    <div class="col-md-3 col-sm-6">
                                        <label> Use Case ID <span style="color:red"></span></label>
                                        <input type="text" class="form-control" placeholder="Use Case ID" disabled ng-model="crtUsercaseId" required>
                                    </div>
                                    <div class="col-md-3 col-sm-6">
                                        <label> Use Case Name <span style="color:red"></span></label>
                                        <input type="text" class="form-control" placeholder="Use Case Name" disabled ng-model="crtUsercaseName" required>
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div class="margintp1 col-md-12 col-sm-12 ">
                                <div class="row">
                                    <div class="col-md-4 col-sm-6 form-group" ng-class="{ 'has-error': updateRuleFrom.crtRuleID.$error.required }">
                                        <label> Rule ID <span style="color:red">*</span></label>
                                        <input type="text" class="form-control" maxlength="20" placeholder="Rule ID" id="crtRuleID" name="crtRuleID" ng-model="crtRuleID" required>
                                        <span ng-show="updateRuleFrom.crtRuleID.$error.required" class="help-block">This field is required</span>
                                    </div>
                                    <div class="col-md-4 col-sm-6 form-group" ng-class="{ 'has-error': updateRuleFrom.crtRuleName.$error.required }">
                                        <label> Rule Name <span style="color:red">*</span></label>
                                        <input type="text" class="form-control" placeholder="Rule Name" maxlength="100" id="crtRuleName" name="crtRuleName" ng-model="crtRuleName" required>
                                        <span ng-show="updateRuleFrom.crtRuleName.$error.required" class="help-block">This field is required</span>
                                    </div>
                                <div class="col-md-4 col-sm-6">
                                    <label> Out of Box </label><br>
								<select class="form-control valselect" ng-model="uformcontrolYN">
								<!-- ng-change=uyngetDetailscr() -->
									<option>Yes</option>
									<option>No</option>
								</select>
                                </div>
                                    <div class="clearfix"></div>
                                    <div class="margintp1">
                                        <div class="col-md-12 col-sm-6">
                                            <label> Rule Description </label>
                                            <textarea rows="3" cols="30" class="form-control" maxlength="2000" placeholder="Rule Description" ng-model="crtRuleDsecpt"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="tabs">
                        <div class="tabsreg">
                            <div class="margintp1 col-md-12">
                                <div class="row">
                                    <div class="tabheader">
                                        <li class="tabshead"><a herf="" ng-class="licreateruledetails" ng-click="lidetails()"> Rule Details</a></li>
                                        <li class="tabshead"><a herf="" ng-class="licreateruleinput" ng-click="liinput()"> Inputs</a></li>
                                        <!--<li class="tabshead"><a herf="" ng-class="licreateruleinputdata" ng-click="liinputdata()"> Input Data Elements</a></li>
                                <li class="tabshead"><a herf="" ng-class="licreaterulelog" ng-click="lilog()"> Log Resource</a></li>-->
                                        <li class="tabshead"><a herf="" ng-class="licreateruleoutput" ng-click="lioutput()"> Output</a></li>
                                        <li class="tabshead"><a herf="" ng-class="licreaterulethd" ng-click="lithd()"> Threat Model</a></li>
                                       <!--  <li class="tabshead"><a herf="" ng-class="licreateruleresponse" ng-click="liresponse()"> Response</a></li> -->
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="ruledetails" ng-show="ruledetails">
                                <div class="row margintp1">
                                    <div class=" col-md-4 ">
                                        <label>Pseudo Code </label>
                                        <textarea class="form-control" placeholder="Pseudo Code" maxlength="2000" ng-model="crtRulepesducode" id="crtRulepesducode" name="crtRulepesducode"></textarea>
                                    </div>

                                    <div class=" col-md-4">
                                        <label>Saved Search logic</label>
                                        <textarea class="form-control" placeholder="Saved Search logic" maxlength="2000" id="crtRuleSaveSrchlogic" ng-model="crtRuleSaveSrchlogic" name="crtRuleSaveSrchlogic"></textarea>

                                    </div>
                                    <div class=" col-md-4 ">
                                        <label>Building Blocks </label>
                                        <textarea class="form-control" placeholder="Building Blocks" maxlength="5000" name="crtRuleBuildlogic" ng-model="crtRuleBuildlogic"></textarea>

                                    </div>

                                </div>
                                <div class="clearfix"></div>
                                <div class="row margintp1">
                                    <div class=" col-md-4 ">
                                        <label>Reference Set </label>
                                        <textarea class="form-control" placeholder="Reference Set " maxlength="2000" name="crtRuleRefSet" ng-model="crtRuleRefSet"></textarea>

                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="margintp1 col-md-12">
                                    <div class="col-md-offset-4 col-md-4">
                                        <!--<button type="reset" class="btn btn-none tabsbtn"> Clear</button>-->
                                        <button class="btn btn-primary tabsbtn" ng-click="liinput()"> Next </button>
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="ruleinput" ng-show="ruleinput">
                                <div class="row margintp1">
                                    <div class="col-md-4">
                                        <label>Transactional Data </label>
                                        </label>
                                        <select multiple class="form-control" ng-model="crtRuleTrsn" name="crtRuleTrsn" ng-options="transdata.SurrId as transdata.Name for transdata in transdatas  | orderBy:'Name'">
                                        </select>

                                    </div>
                                    <div class="col-md-4 ">
                                        <label>Refrential Data</label>
                                        <select multiple class="form-control" ng-model="crtRuleRefr" name="crtRuleRefr" ng-options="Referdata.SurrId as Referdata.Name for Referdata in Referdatas | orderBy:'Name'">
                                        </select>

                                    </div>
                                    <div class="col-md-4">
                                        <label>Event Name/ Categroy </label>
                                        <select multiple class="form-control" ng-model="crtRuleEventName" name="crtRuleEventName" ng-options="eventcatdata.SurrId as eventcatdata.Name for eventcatdata in eventcatdatas | orderBy:'Name'" required>
                                        </select>

                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="row margintp1">
                                    <div class="col-md-4 ">
                                        <label>Event Attributes</label>
                                        <select multiple class="form-control" ng-model="crtRuleEventAttribute" name="crtRuleEventAttribute" ng-options="eventAttr.SurrId as eventAttr.Name for eventAttr in dataeventAttr | orderBy:'Name'" required>
                                        </select>

                                    </div>
                                    <div class="col-md-4 ">
                                        <label>Log Source </label>
                                        <select multiple class="form-control" ng-model="crtRuleLogSource" name="crtRuleLogSource" ng-options="logdata.SurrId as logdata.Name for logdata in LogSource | orderBy:'Name'">
                                        </select>

                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="margintp1 col-md-12">
                                    <div class="col-md-offset-4 col-md-4">
                                        <!--<button type="reset" class="btn btn-none tabsbtn"> Clear</button>-->
                                        <button class="btn btn-primary tabsbtn" ng-click="lioutput()"> Next </button>
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="ruleinput" ng-show="ruleoutput">
                                <div class="row margintp1">
                                    <div class="col-md-4 ">
                                        <label>DashBoard </label>
                                        <select class="form-control" ng-model="crtRuleDashBoard" name="crtRuleDashBoard" ng-options="dash.SurrId as dash.Name for dash in dashboarddatas | orderBy:'Name'">
                                        </select>
                                    </div>
                                    <div class="col-md-4 ">
                                        <label>Alert </label>
                                        <select class="form-control" ng-model="crtRuleAlert" name="crtRuleAlert" ng-options="alert.SurrId as alert.Name for alert in alertdatas | orderBy:'Name'">
                                        </select>
                                    </div>
                                    <div class="col-md-4 ">
                                        <label>Reference Set </label>
                                        <select class="form-control" ng-model="crtReferSet" name="crtReferSet" ng-options="refeset.SurrId as refeset.Name for refeset in refesetdatas | orderBy:'Name'">
                                        </select>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="row margintp1">
                                    <div class="col-md-4 ">
                                        <label>Report </label>
                                        <select multiple class="form-control" ng-model="crtRuleReport" name="crtRuleReport" ng-options="Reportdata.SurrId as Reportdata.Name for Reportdata in Reportdatas">
                                        </select>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="margintp1 col-md-12">
                                    <div class="col-md-offset-4 col-md-4">
                                        <!--<button class="btn btn-none tabsbtn" type="reset"> Clear</button>-->
                                        <button class="btn btn-primary tabsbtn" ng-click="lithd()"> Next </button>
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        <div class="rulethd" ng-show="rulethd">
                            <div class="row margintp1">
                                <div class="col-md-3 col-sm-6">
                                    <label> CAPEC Category </label>
                                    <select class="form-control" ng-model="UsecasecapecCat" ng-change="thdCape_extch()" ng-blur="thdCape_ch()">
                                        <option ng-selected="UsecasecapecCat == thdCapdata.SurrId" ng-repeat="thdCapdata in thdCapdatas  | orderBy:'Name'" value="{{thdCapdata.SurrId}}">
                                            {{thdCapdata.Name}} {{thdCapdata.ID}}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-md-3 col-sm-6">
                                    <label> Meta Attack </label>
                                    <select class="form-control" ng-model="UsecaseMetaAtt" ng-change="thdMeta_extch()" ng-blur="thdMeta_ch()">
                                        <option ng-selected="UsecaseMetaAtt == thdMetadata.SurrId" ng-repeat="thdMetadata in thdMetadatas | orderBy:'Name'" value="{{thdMetadata.SurrId}}">
                                            {{thdMetadata.Name}} {{thdMetadata.ID}}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-md-3 col-sm-6">
                                    <label> Standard Attack </label>
                                    <select class="form-control" ng-model="UsecaseStrdAtt" ng-change="thdStrd_extch()" ng-blur="thdStrd_ch()">
                                        <option ng-selected="UsecaseStrdAtt == thdStrddata.SurrId" ng-repeat="thdStrddata in thdStrddatas | orderBy:'Name'" value="{{thdStrddata.SurrId}}">
                                            {{thdStrddata.Name}} {{thdStrddata.ID}}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-md-3 col-sm-6">
                                    <label> </label>
                                    <button class="tabsbtn btn btn-primary" ng-click="thdUsecase_add()"> Add</button>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="row">
                            <div class="col-md-12">
                                <div class="panel panel-default">
                                    <table class="table table-striped tableusecase">
                                        <thead>
                                            <th> CAPEC Category</th>
                                            <th>Meta Attack</th>
                                            <th>Standard Attack</th>
                                            <th></th>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="ThdCrt in ThdCrttables">
                                                <td>{{ThdCrt.Thdcat}} </td>
                                                <td>{{ThdCrt.ThdPub}}</td>
                                                <td>{{ThdCrt.ThdCrtl}}</td>
                                                <td><i class="glyphicon glyphicon-trash mousePt" ng-click="Thdtableremove(ThdCrttables, $index)"></i> </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                            <div class="clearfix"></div>
                            <div class="margintp1 col-md-12">
                                <div class="col-md-offset-4 col-md-4">
                                   <!--  <button class="btn btn-primary tabsbtn" ng-click="liresponse()"> Next </button> -->
                                     <button class="btn btn-none tabsbtn" ng-click="reSet()" id="reSet"> Clear</button>
                                     <button type="submit" class="btn btn-primary tabsbtn" ng-click="crtRuleSubmit()"> Submit </button>
                                </div>
                            </div>
                        </div>
           <!--                  <div class="clearfix"></div>
                            <div class="ruleinput" ng-show="ruleresponse">
                                <div class="row margintp1">
                                    <div class="col-md-4 ">
                                        <label>Response </label>
                                        <textarea class="form-control" maxlength="5000" ng-model="crtRuleResponse" name="crtRuleResponse"></textarea>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="margintp1 col-md-12">
                                    <div class="col-md-offset-4 col-md-4">
                                        <button class="btn btn-none tabsbtn" ng-click="reSet()" id="reSet"> Clear</button>
                                        <button type="submit" class="btn btn-primary tabsbtn" ng-click="crtRuleSubmit()"> Submit </button>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>